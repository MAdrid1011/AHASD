{
  "experiment_name": "AHASD_Evaluation",
  "description": "AHASD: Asynchronous Heterogeneous Architecture for LLM Speculative Decoding",
  
  "models": {
    "small": {
      "draft": {
        "name": "OPT-1.3B",
        "hidden_size": 2048,
        "num_layers": 24,
        "num_heads": 32,
        "vocab_size": 50272,
        "quantization": "INT8"
      },
      "target": {
        "name": "OPT-6.7B",
        "hidden_size": 4096,
        "num_layers": 32,
        "num_heads": 32,
        "vocab_size": 50272,
        "quantization": "INT8"
      }
    },
    "medium": {
      "draft": {
        "name": "LLaMA2-7B",
        "hidden_size": 4096,
        "num_layers": 32,
        "num_heads": 32,
        "vocab_size": 32000,
        "quantization": "INT8"
      },
      "target": {
        "name": "LLaMA2-13B",
        "hidden_size": 5120,
        "num_layers": 40,
        "num_heads": 40,
        "vocab_size": 32000,
        "quantization": "INT8"
      }
    },
    "large": {
      "draft": {
        "name": "PaLM-8B",
        "hidden_size": 4096,
        "num_layers": 32,
        "num_heads": 16,
        "vocab_size": 256000,
        "quantization": "INT8"
      },
      "target": {
        "name": "PaLM-62B",
        "hidden_size": 8192,
        "num_layers": 64,
        "num_heads": 32,
        "vocab_size": 256000,
        "quantization": "INT8"
      }
    }
  },
  
  "adaptive_algorithms": {
    "specdec": {
      "name": "SpecDec++",
      "description": "Adaptive draft length based on entropy threshold",
      "max_draft_length": 16,
      "entropy_threshold": 2.5,
      "confidence_window": 4
    },
    "svip": {
      "name": "SVIP",
      "description": "Speculative Verification with Incremental Parsing",
      "max_draft_length": 12,
      "verification_threshold": 0.8,
      "incremental_steps": 2
    },
    "adaedl": {
      "name": "AdaEDL",
      "description": "Adaptive Early Draft Length control",
      "max_draft_length": 16,
      "adaptation_rate": 0.1,
      "history_length": 8
    },
    "banditspec": {
      "name": "BanditSpec",
      "description": "Multi-armed bandit for draft length selection",
      "max_draft_length": 20,
      "exploration_rate": 0.15,
      "ucb_constant": 1.5
    }
  },
  
  "ahasd_configuration": {
    "enable_edc": true,
    "enable_tvc": true,
    "enable_aau": true,
    "enable_gated_scheduler": true,
    
    "edc_parameters": {
      "leht_size": 8,
      "pht_size": 512,
      "pht_counter_bits": 2,
      "h_max": 10.0,
      "entropy_buckets": 8
    },
    
    "tvc_parameters": {
      "cycle_table_size": 4,
      "min_preverify_length": 2,
      "max_preverify_length": 8,
      "conservative_mode": true
    },
    
    "aau_parameters": {
      "vector_width": 16,
      "pipeline_stages": 4,
      "throughput_gops": 2.5,
      "latency_cycles": 8,
      "supported_operations": ["GELU", "Softmax", "LayerNorm", "Attention"]
    },
    
    "async_queues": {
      "unverified_draft_size": 64,
      "feedback_queue_size": 32,
      "preverify_queue_size": 16
    }
  },
  
  "hardware_configuration": {
    "npu": {
      "type": "Mobile NPU (Coral-like)",
      "systolic_array": {
        "size": "128x128",
        "frequency_ghz": 1.0,
        "throughput_tflops": 16.0,
        "data_type": "INT8"
      },
      "vector_unit": {
        "frequency_ghz": 1.0,
        "throughput_tflops": 8.2
      },
      "scratchpad": {
        "capacity_mb": 8,
        "bandwidth_gbs": 512
      },
      "num_chips": 2,
      "power_model": "CoralNPU_28nm"
    },
    
    "pim": {
      "type": "LPDDR5-PIM",
      "num_ranks": 16,
      "rank_capacity_gb": 4,
      "num_banks_per_rank": 16,
      "frequency_mhz": 800,
      "performance_int8_gops": 102.4,
      "on_chip_bandwidth_gbs": 256,
      "off_chip_bandwidth_gbs": 51.2,
      
      "timing_parameters": {
        "tRP": 32,
        "tRCD": 32,
        "tRAS": 64,
        "tRRD_L": 8,
        "tWR": 24,
        "tCCD_S": 4,
        "tCCD_L": 6,
        "tREFI": 6240,
        "tFAW": 64,
        "tRFC": 560
      },
      
      "power_model": "LPDDR5_28nm"
    },
    
    "interconnect": {
      "type": "AXI4",
      "frequency_ghz": 1.0,
      "data_width_bits": 512,
      "latency_cycles": 10
    }
  },
  
  "simulation_parameters": {
    "generation_length": 1024,
    "batch_size": 1,
    "warmup_tokens": 128,
    "enable_trace": true,
    "trace_interval": 100,
    "print_interval": 1000,
    "random_seed": 42,
    
    "benchmarks": [
      "chatbot",
      "code_generation",
      "summarization",
      "translation"
    ]
  },
  
  "baseline_configurations": {
    "gpu_only": {
      "description": "Sequential execution on GPU",
      "device": "NVIDIA RTX 5090 (Laptop)",
      "memory_gb": 16,
      "enable_async": false
    },
    
    "specpim": {
      "description": "SpecPIM operator-level parallelism",
      "gpu": "NVIDIA RTX 5090 (Laptop)",
      "pim": "HBM-PIM",
      "synchronization": "operator_level",
      "fixed_draft_length": 8
    },
    
    "amusd": {
      "description": "Asynchronous task-level without AHASD optimizations",
      "enable_async": true,
      "enable_edc": false,
      "enable_tvc": false,
      "enable_aau": false
    }
  },
  
  "output_configuration": {
    "results_directory": "./results",
    "save_traces": true,
    "save_statistics": true,
    "generate_plots": true,
    "plot_formats": ["png", "pdf"],
    "save_checkpoints": false,
    "checkpoint_interval": 1000
  },
  
  "validation": {
    "enable_correctness_check": true,
    "compare_with_reference": true,
    "max_token_divergence": 0,
    "energy_tolerance_percent": 5.0
  }
}

